knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/plewis/Documents/projects/SMC2/tiny-sim/analysis")
library(lorad)
plot(density(params$incr.default.0), lwd=2, col="black", bty="L")
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/plewis/Documents/projects/SMC2/tiny-sim/analysis")
library(lorad)
params <- read.table('params-iter0.txt', header=TRUE)
dim(params)
colnames(params)
plot(density(params$incr.default.0), lwd=2, col="black", bty="L")
lines(density(params$incr.default.1), lwd=2, col="purple")
lines(density(params$incr.default.2), lwd=2, col="blue")
d0 <- density(params$incr.default.0)
d1 <- density(params$incr.default.1)
d2 <- density(params$incr.default.2)
xmax <- max(d0$x,d1$x,d2$x)
ymax <- max(d0$y,d1$y,d2$y)
plot(d0, lwd=2, col="black", bty="L", xlim=c(0,xmax), ylim=c(0,ymax))
lines(d1, lwd=2, col="purple")
lines(s2, lwd=2, col="blue")
d0 <- density(params$incr.default.0)
d1 <- density(params$incr.default.1)
d2 <- density(params$incr.default.2)
xmax <- max(d0$x,d1$x,d2$x)
ymax <- max(d0$y,d1$y,d2$y)
plot(d0, lwd=2, col="black", bty="L", xlim=c(0,xmax), ylim=c(0,ymax))
lines(d1, lwd=2, col="purple")
lines(d2, lwd=2, col="blue")
d0 <- density(params$incr.default.0)
d1 <- density(params$incr.default.1)
d2 <- density(params$incr.default.2)
xmax <- max(d0$x,d1$x,d2$x)
ymax <- max(d0$y,d1$y,d2$y)
plot(d0, lwd=2, col="black", bty="L", xlim=c(0,xmax), ylim=c(0,ymax), main="Density plots for increment parameters")
lines(d1, lwd=2, col="purple")
lines(d2, lwd=2, col="blue")
sum(ifelse(split.default.0 == "--**",1,0))
sum(ifelse(params$split.default.0 == "--**",1,0))
print(sum(ifelse(params$split.default.0 == "--**",1,0)))
sprintf("%d",sum(ifelse(params$split.default.0 == "--**",1,0)))
cat("Number of samples:\n")
sprintf("%d", dim(params)[1])
cat("Number of samples in which first coalescent event joins the two samples from species B:\n")
sprintf("%d",sum(ifelse(params$split.default.0 == "--**",1,0)))
cat("Number of samples:\n")
sprintf("%d", dim(params)[1])
cat("Number of samples in which first coalescent event joins the two samples from species B:\n")
sprintf("%d",sum(ifelse(params$split.default.0 == "--**",1,0)))
cat("Number of samples in which second coalescent event joins the two samples from species A:\n")
sprintf("%d",sum(ifelse(params$split.default.1 == "**--",1,0)))
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/plewis/Documents/projects/SMC2/tiny-sim/analysis")
library(lorad)
params <- read.table('params-iter0.txt', header=TRUE)
dim(params)
colnames(params)
colspec <- c("particle"="iteration", "lnL.default"="posterior", "lnP.default"="posterior", "incr.default.0"="nonnegative", "incr.default.1"="nonnegative", "incr.default.2"="nonnegative", "split.default.0"="ignore", "split.default.1"="ignore", "split.default.2"="ignore")
colspec
d0 <- density(params$incr.default.0)
d1 <- density(params$incr.default.1)
d2 <- density(params$incr.default.2)
xmax <- max(d0$x,d1$x,d2$x)
ymax <- max(d0$y,d1$y,d2$y)
plot(d0, lwd=2, col="black", bty="L", xlim=c(0,xmax), ylim=c(0,ymax), main="Densities for increment parameters")
lines(d1, lwd=2, col="purple")
lines(d2, lwd=2, col="blue")
cat("Number of samples:\n")
sprintf("%d", dim(params)[1])
cat("Number of samples in which first coalescent event joins the two samples from species B:\n")
sprintf("%d",sum(ifelse(params$split.default.0 == "--**",1,0)))
cat("Number of samples in which second coalescent event joins the two samples from species A:\n")
sprintf("%d",sum(ifelse(params$split.default.1 == "**--",1,0)))
lorad_estimate(params, colspec, 0.5, "random", 0.1)
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/plewis/Documents/projects/SMC2/tiny-sim/analysis")
library(lorad)
paste(sprintf("%d: Number of samples", dim(params)[1]),
sprintf("%d: Number of samples in which first coalescent event joins the two samples from species B",sum(ifelse(params$split.default.0 == "--**",1,0))),
sprintf("%d: Number of samples in which first coalescent event joins the two samples from species A",sum(ifelse(params$split.default.1 == "**--",1,0))))
paste(sprintf("%d: Number of samples", dim(params)[1]),"\n"
sprintf("%d: Number of samples in which first coalescent event joins the two samples from species B",sum(ifelse(params$split.default.0 == "--**",1,0))),"\n"
paste(sprintf("%d: Number of samples", dim(params)[1]),"\n",
sprintf("%d: Number of samples in which first coalescent event joins the two samples from species B",sum(ifelse(params$split.default.0 == "--**",1,0))),"\n",
sprintf("%d: Number of samples in which first coalescent event joins the two samples from species A",sum(ifelse(params$split.default.1 == "**--",1,0))))
cat(paste(sprintf("%d: Number of samples", dim(params)[1]),"\n",
sprintf("%d: Number of samples in which first coalescent event joins the two samples from species B",sum(ifelse(params$split.default.0 == "--**",1,0))),"\n",
sprintf("%d: Number of samples in which first coalescent event joins the two samples from species A",sum(ifelse(params$split.default.1 == "**--",1,0)))))
cat(paste(sprintf("%12d: Number of samples", dim(params)[1]),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species B",sum(ifelse(params$split.default.0 == "--**",1,0))),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species A",sum(ifelse(params$split.default.1 == "**--",1,0)))))
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/plewis/Documents/projects/SMC2/tiny-sim/analysis")
library(lorad)
params <- read.table('params-iter0.txt', header=TRUE)
dim(params)
colnames(params)
colspec <- c("particle"="iteration", "lnL.default"="posterior", "lnP.default"="posterior", "incr.default.0"="nonnegative", "incr.default.1"="nonnegative", "incr.default.2"="nonnegative", "split.default.0"="ignore", "split.default.1"="ignore", "split.default.2"="ignore")
colspec
d0 <- density(params$incr.default.0)
d1 <- density(params$incr.default.1)
d2 <- density(params$incr.default.2)
xmax <- max(d0$x,d1$x,d2$x)
ymax <- max(d0$y,d1$y,d2$y)
plot(d0, lwd=2, col="black", bty="L", xlim=c(0,xmax), ylim=c(0,ymax), main="Densities for increment parameters")
lines(d1, lwd=2, col="purple")
lines(d2, lwd=2, col="blue")
cat(paste(sprintf("%12d: Number of samples", dim(params)[1]),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species B",sum(ifelse(params$split.default.0 == "--**",1,0))),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species A",sum(ifelse(params$split.default.1 == "**--",1,0)))))
lorad_estimate(params, colspec, 0.5, "random", 0.1)
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/plewis/Documents/projects/SMC2/tiny-sim/analysis")
library(lorad)
params <- read.table('params-iter0.txt', header=TRUE)
dim(params)
colnames(params)
colspec <- c("particle"="iteration", "lnL.default"="posterior", "lnP.default"="posterior", "incr.default.0"="nonnegative", "incr.default.1"="nonnegative", "incr.default.2"="nonnegative", "split.default.0"="ignore", "split.default.1"="ignore", "split.default.2"="ignore")
colspec
d0 <- density(params$incr.default.0)
d1 <- density(params$incr.default.1)
d2 <- density(params$incr.default.2)
xmax <- max(d0$x,d1$x,d2$x)
ymax <- max(d0$y,d1$y,d2$y)
plot(d0, lwd=2, col="black", bty="L", xlim=c(0,xmax), ylim=c(0,ymax), main="Densities for increment parameters")
lines(d1, lwd=2, col="purple")
lines(d2, lwd=2, col="blue")
cat(paste(sprintf("%12d: Number of samples", dim(params)[1]),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species B",sum(ifelse(params$split.default.0 == "--**",1,0))),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species A",sum(ifelse(params$split.default.1 == "**--",1,0)))))
lorad_estimate(params, colspec, 0.5, "random", 0.1)
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/plewis/Documents/projects/SMC2/tiny-sim/analysis")
library(lorad)
params <- read.table('params-iter0.txt', header=TRUE)
dim(params)
colnames(params)
free2 <- params$incr.default.2 - 0.038273807
constr2 <- params$incr.default.2 - free2
data <- data.frame(params$particle, params$lnL.default, params$lnP.default, params$incr.default.0, params$incr.default.1, , params$incr.default.1, constr2, free2)
free2 <- params$incr.default.2 - 0.038273807
constr2 <- params$incr.default.2 - free2
data <- data.frame(params$particle, params$lnL.default, params$lnP.default, params$incr.default.0, params$incr.default.1, params$incr.default.2, constr2, free2)
colnames(data)
colspec_params <- c("particle"="iteration", "lnL.default"="posterior", "lnP.default"="posterior", "incr.default.0"="nonnegative", "incr.default.1"="nonnegative", "incr.default.2"="nonnegative", "split.default.0"="ignore", "split.default.1"="ignore", "split.default.2"="ignore")
colspec_params
colspec_data <- c("particle"="iteration", "lnL.default"="posterior", "lnP.default"="posterior", "incr.default.0"="nonnegative", "incr.default.1"="nonnegative", "incr.default.2"="nonnegative", "constr2"="nonnegative", "free2"="nonnegative")
colspec_data
d0 <- density(data$incr.default.0)
d0 <- density(data$params.incr.default.0)
d1 <- density(data$params.incr.default.1)
d2a <- density(data$constr2)
d2b <- density(data$free2)
xmax <- max(d0$x,d1$x,d2a$x,d2b$x)
ymax <- max(d0$y,d1$y,d2a$y,d2b$y)
plot(d0, lwd=2, col="black", bty="L", xlim=c(0,xmax), ylim=c(0,ymax), main="Densities for increment parameters")
lines(d1, lwd=2, col="purple")
lines(d2a, lwd=2, col="blue")
lines(d2b, lwd=2, col="blue", lty="dotted")
data$free2
constr2 <- 0.038273807 - params$incr.default.0 - params$incr.default.1
free2 <- params$incr.default.2 - constr2
data <- data.frame(params$particle, params$lnL.default, params$lnP.default, params$incr.default.0, params$incr.default.1, params$incr.default.2, constr2, free2)
colnames(data)
colspec_params <- c("particle"="iteration", "lnL.default"="posterior", "lnP.default"="posterior", "incr.default.0"="nonnegative", "incr.default.1"="nonnegative", "incr.default.2"="nonnegative", "split.default.0"="ignore", "split.default.1"="ignore", "split.default.2"="ignore")
colspec_params
colspec_data <- c("particle"="iteration", "lnL.default"="posterior", "lnP.default"="posterior", "incr.default.0"="nonnegative", "incr.default.1"="nonnegative", "incr.default.2"="nonnegative", "constr2"="nonnegative", "free2"="nonnegative")
colspec_data
data$free2
d0 <- density(data$params.incr.default.0)
d1 <- density(data$params.incr.default.1)
d2a <- density(data$constr2)
d2b <- density(data$free2)
xmax <- max(d0$x,d1$x,d2a$x,d2b$x)
ymax <- max(d0$y,d1$y,d2a$y,d2b$y)
plot(d0, lwd=2, col="black", bty="L", xlim=c(0,xmax), ylim=c(0,ymax), main="Densities for increment parameters")
lines(d1, lwd=2, col="purple")
lines(d2a, lwd=2, col="blue")
lines(d2b, lwd=2, col="blue", lty="dotted")
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/plewis/Documents/projects/SMC2/tiny-sim/analysis")
library(lorad)
params <- read.table('params-iter0.txt', header=TRUE)
dim(params)
colnames(params)
constr2 <- 0.038273807 - params$incr.default.0 - params$incr.default.1
free2 <- params$incr.default.2 - constr2
data <- data.frame(params$particle, params$lnL.default, params$lnP.default, params$incr.default.0, params$incr.default.1, params$incr.default.2, constr2, free2)
colnames(data)
colspec_params <- c("particle"="iteration", "lnL.default"="posterior", "lnP.default"="posterior", "incr.default.0"="nonnegative", "incr.default.1"="nonnegative", "incr.default.2"="nonnegative", "split.default.0"="ignore", "split.default.1"="ignore", "split.default.2"="ignore")
colspec_params
colspec_data <- c("particle"="iteration", "lnL.default"="posterior", "lnP.default"="posterior", "incr.default.0"="nonnegative", "incr.default.1"="nonnegative", "incr.default.2"="nonnegative", "constr2"="nonnegative", "free2"="nonnegative")
colspec_data
d0 <- density(data$params.incr.default.0)
d1 <- density(data$params.incr.default.1)
d2a <- density(data$constr2)
d2b <- density(data$free2)
xmax <- max(d0$x,d1$x,d2a$x,d2b$x)
ymax <- max(d0$y,d1$y,d2a$y,d2b$y)
plot(d0, lwd=2, col="black", bty="L", xlim=c(0,xmax), ylim=c(0,ymax), main="Densities for increment parameters")
lines(d1, lwd=2, col="purple")
lines(d2a, lwd=2, col="blue")
lines(d2b, lwd=2, col="blue", lty="dotted")
cat(paste(sprintf("%12d: Number of samples", dim(params)[1]),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species B",sum(ifelse(params$split.default.0 == "--**",1,0))),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species A",sum(ifelse(params$split.default.1 == "**--",1,0)))))
cat(paste(sprintf("%12d: Number of samples", dim(params)[1]),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species A",sum(ifelse(params$split.default.0 == "**--",1,0))),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species B",sum(ifelse(params$split.default.1 == "--**",1,0)))))
lorad_estimate(params, colspec_params, 0.5, "random", 0.1)
lorad_estimate(data, colspec_data, 0.5, "random", 0.1)
lorad_estimate(data, colspec_data, 0.5, "random", 0.1)
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/plewis/Documents/projects/SMC2/tiny-sim/analysis")
library(lorad)
params <- read.table('params-iter0.txt', header=TRUE)
dim(params)
colnames(params)
constr2 <- 0.038273807 - params$incr.default.0 - params$incr.default.1
free2 <- params$incr.default.2 - constr2
data <- data.frame(params$particle, params$lnL.default, params$lnP.default, params$incr.default.0, params$incr.default.1, params$incr.default.2, constr2, free2)
colnames(data)
colspec_params <- c("particle"="iteration", "lnL.default"="posterior", "lnP.default"="posterior", "incr.default.0"="nonnegative", "incr.default.1"="nonnegative", "incr.default.2"="nonnegative", "split.default.0"="ignore", "split.default.1"="ignore", "split.default.2"="ignore")
colspec_params
colspec_data <- c("particle"="iteration", "params.lnL.default"="posterior", "params.lnP.default"="posterior", "params.incr.default.0"="nonnegative", "params.incr.default.1"="nonnegative", "params.incr.default.2"="nonnegative", "constr2"="nonnegative", "free2"="nonnegative")
colspec_data
d0 <- density(data$params.incr.default.0)
d1 <- density(data$params.incr.default.1)
d2a <- density(data$constr2)
d2b <- density(data$free2)
xmax <- max(d0$x,d1$x,d2a$x,d2b$x)
ymax <- max(d0$y,d1$y,d2a$y,d2b$y)
plot(d0, lwd=2, col="black", bty="L", xlim=c(0,xmax), ylim=c(0,ymax), main="Densities for increment parameters")
lines(d1, lwd=2, col="purple")
lines(d2a, lwd=2, col="blue")
lines(d2b, lwd=2, col="blue", lty="dotted")
cat(paste(sprintf("%12d: Number of samples", dim(params)[1]),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species A",sum(ifelse(params$split.default.0 == "**--",1,0))),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species B",sum(ifelse(params$split.default.1 == "--**",1,0)))))
lorad_estimate(params, colspec_params, 0.5, "random", 0.1)
lorad_estimate(data, colspec_data, 0.5, "random", 0.1)
colspec_data <- c("params.particle"="iteration", "params.lnL.default"="posterior", "params.lnP.default"="posterior", "params.incr.default.0"="nonnegative", "params.incr.default.1"="nonnegative", "params.incr.default.2"="nonnegative", "constr2"="nonnegative", "free2"="nonnegative")
colspec_data
lorad_estimate(data, colspec_data, 0.5, "random", 0.1)
colspec_data <- c("params.particle"="iteration", "params.lnL.default"="posterior", "params.lnP.default"="posterior", "params.incr.default.0"="nonnegative", "params.incr.default.1"="nonnegative", "params.incr.default.2"="ignore", "constr2"="ignore", "free2"="nonnegative")
colspec_data
lorad_estimate(data, colspec_data, 0.5, "random", 0.1)
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/plewis/Documents/projects/SMC2/tiny-sim/gene-marglike")
library(lorad)
params <- read.table('gene-params.txt', header=TRUE)
dim(params)
colnames(params)
constr2 <- 0.038273807 - params$incr.default.0 - params$incr.default.1
free2 <- params$incr.default.2 - constr2
data <- data.frame(params$particle, params$lnL.default, params$lnP.default, params$incr.default.0, params$incr.default.1, params$incr.default.2, constr2, free2)
colnames(data)
colspec_params <- c("particle"="iteration", "lnL.default"="posterior", "lnP.default"="posterior", "incr.default.0"="nonnegative", "incr.default.1"="nonnegative", "incr.default.2"="nonnegative", "split.default.0"="ignore", "split.default.1"="ignore", "split.default.2"="ignore")
colspec_params
colspec_data <- c("params.particle"="iteration", "params.lnL.default"="posterior", "params.lnP.default"="posterior", "params.incr.default.0"="nonnegative", "params.incr.default.1"="nonnegative", "params.incr.default.2"="ignore", "constr2"="ignore", "free2"="nonnegative")
colspec_data
d0 <- density(data$params.incr.default.0)
d1 <- density(data$params.incr.default.1)
d2a <- density(data$constr2)
d2b <- density(data$free2)
xmax <- max(d0$x,d1$x,d2a$x,d2b$x)
ymax <- max(d0$y,d1$y,d2a$y,d2b$y)
plot(d0, lwd=2, col="black", bty="L", xlim=c(0,xmax), ylim=c(0,ymax), main="Densities for increment parameters")
lines(d1, lwd=2, col="purple")
lines(d2a, lwd=2, col="blue")
lines(d2b, lwd=2, col="blue", lty="dotted")
cat(paste(sprintf("%12d: Number of samples", dim(params)[1]),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species A",sum(ifelse(params$split.default.0 == "**--",1,0))),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species B",sum(ifelse(params$split.default.1 == "--**",1,0)))))
cat(paste(sprintf("%12d: Number of samples", dim(params)[1]),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species B",sum(ifelse(params$split.default.0 == "--**",1,0))),
sprintf("\n%12d: Number of samples in which first coalescent event joins the two samples from species A",sum(ifelse(params$split.default.1 == "**--",1,0)))))
lorad_estimate(params, colspec_params, 0.5, "random", 0.1)
lorad_estimate(data, colspec_data, 0.5, "random", 0.1)
